{"changed":true,"filter":false,"title":"bus.php","tooltip":"/bus.php","value":"<script\n  src=\"https://code.jquery.com/jquery-3.2.1.min.js\"\n  integrity=\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\"\n  crossorigin=\"anonymous\"></script>\n<?php\nrequire_once __DIR__ . '/vendor/autoload.php';\nrequire_once __DIR__ . '/Operations/helpers.php';\nrequire_once __DIR__ . '/Operations/database.php';\n\n(new Dotenv\\Dotenv(__DIR__ . '/Operations'))->load();\nrequireAuth();\n\n\n?>\n\n<!doctype html>\n<html lang=\"en\">\n    <head>\n        <title>Stop Saver</title>\n\n    </head>\n    <body>\n        <ul>\n            <li><a href=\"/\">Home</a></li>\n            <li><a href=\"/bus.php\">List of Buses</a></li>\n            <li><a href=\"/add.php\">Add a New Bus</a></li>\n        </ul>\n\n       <ul>\n            <?php if(!userAuth()) : ?>\n            <li><a href=\"/login.php\">Login</a></li>\n            <li><a href=\"/register.php\">Register</a></li>\n            <?php else: ?>\n            <li><a href=\"/SignUp/Ologout.php\">Logout</a></li>\n            <?php endif; ?>\n        </ul>\n\n<div>\n        <h2>List of Journeys</h2>\n    \n        <?php \n        foreach (getAllBuses() as $bus): ?>\n                <h4><?php echo $bus['title']; ?></h4>\n                <p> <?php echo $bus['stopno']; ?> </p>\n                <p>User ID: <?php echo $bus['user_id']; ?> </p>\n                <p> <?php echo $bus['id']; ?> </p>\n                <p id=<?php echo $bus['id']; ?>> </p>\n\n                <div id=\"details\" ><script type=\"text/javascript\">\n                    var cures = <?php echo json_encode( $bus['stopno'] ); ?>;\n                    // $($(function() {\n                    //     $.get('http://numbersapi.com/random/year?json')).done(function(data){\n                    //         console.log(data);\n                            \n                    //         }\n                            \n                    //     }));\n                    //     $($.get('http://numbersapi.com/1337/trivia?notfound=floor&fragment', function(data) {\n                    //         $('#number').text(data);\n                    //         console.log(data)\n                    //     }));\n                        \n                    $(function() {\n                        $.getJSON('https://data.dublinked.ie/cgi-bin/rtpi/realtimebusinformation?stopid='+<?php echo json_encode( $bus['stopno'] ); ?>+'&format=json').done(function(data){\n                            console.log(data);\n                            if (data.errormessage === \"\"){\n                            for(let j in data.results){\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"Stop number \" + <?php echo json_encode( $bus['stopno'] ); ?>);\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"<p>The route going to the stop is: \" + data.results[j].route + \"</p>\");\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"<p>The time that bus is due is: \" + data.results[j].duetime + \"</p>\");\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"<p>The departure time of the route: \" + data.results[j].departuredatetime + \"</p>\");\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"<p>The routes destination: \" + data.results[j].destination + \"</p>\");\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"<p>Any other info about the route: \" + data.results[j].additionalinformation + \"</p><br/>\");\n                            }    \n                            } else {\n                                $(\"#\"+<?php echo $bus['id']; ?>).append(\"<p>Error this bus is not a vaild bus!!!</p><br/>\");\n                            }\n                            \n                        });\n                    });\n                   \n                   \n                </script></div>\n                <span><a href=\"/edit.php?id=<?php echo $bus['id'] ?>\"> Edit </a></span> |\n                <span><a href=\"/CRUD/Odelete.php?busId=<?php echo $bus['id']; ?>\">Delete</a></span>\n\n        <?php endforeach; ?>\n        \n        \n</div>\n</body>\n</html>","undoManager":{"mark":2,"position":2,"stack":[[{"start":{"row":50,"column":20},"end":{"row":50,"column":23},"action":"insert","lines":["// "],"id":2},{"start":{"row":51,"column":20},"end":{"row":51,"column":23},"action":"insert","lines":["// "]},{"start":{"row":52,"column":20},"end":{"row":52,"column":23},"action":"insert","lines":["// "]},{"start":{"row":54,"column":20},"end":{"row":54,"column":23},"action":"insert","lines":["// "]},{"start":{"row":56,"column":20},"end":{"row":56,"column":23},"action":"insert","lines":["// "]},{"start":{"row":57,"column":20},"end":{"row":57,"column":23},"action":"insert","lines":["// "]},{"start":{"row":58,"column":20},"end":{"row":58,"column":23},"action":"insert","lines":["// "]},{"start":{"row":59,"column":20},"end":{"row":59,"column":23},"action":"insert","lines":["// "]},{"start":{"row":60,"column":20},"end":{"row":60,"column":23},"action":"insert","lines":["// "]}],[{"start":{"row":50,"column":20},"end":{"row":50,"column":23},"action":"remove","lines":["// "],"id":3},{"start":{"row":51,"column":20},"end":{"row":51,"column":23},"action":"remove","lines":["// "]},{"start":{"row":52,"column":20},"end":{"row":52,"column":23},"action":"remove","lines":["// "]},{"start":{"row":54,"column":20},"end":{"row":54,"column":23},"action":"remove","lines":["// "]}],[{"start":{"row":50,"column":20},"end":{"row":50,"column":23},"action":"insert","lines":["// "],"id":4},{"start":{"row":51,"column":20},"end":{"row":51,"column":23},"action":"insert","lines":["// "]},{"start":{"row":52,"column":20},"end":{"row":52,"column":23},"action":"insert","lines":["// "]},{"start":{"row":54,"column":20},"end":{"row":54,"column":23},"action":"insert","lines":["// "]}],[{"start":{"row":57,"column":20},"end":{"row":57,"column":23},"action":"remove","lines":["// "],"id":5},{"start":{"row":58,"column":20},"end":{"row":58,"column":23},"action":"remove","lines":["// "]},{"start":{"row":59,"column":20},"end":{"row":59,"column":23},"action":"remove","lines":["// "]},{"start":{"row":60,"column":20},"end":{"row":60,"column":23},"action":"remove","lines":["// "]}]]},"ace":{"folds":[],"scrolltop":750,"scrollleft":0,"selection":{"start":{"row":36,"column":0},"end":{"row":36,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1511790854000}